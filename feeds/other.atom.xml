<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom"><title>ddaa's blog - other</title><link href="https://ddaa.tw/" rel="alternate"></link><link href="https://ddaa.tw/feeds/other.atom.xml" rel="self"></link><id>https://ddaa.tw/</id><updated>2018-08-18T02:22:00+08:00</updated><entry><title>DEF CON 26 CTF Final summary</title><link href="https://ddaa.tw/defcon_26_other_summary.html" rel="alternate"></link><published>2018-08-18T02:22:00+08:00</published><updated>2018-08-18T02:22:00+08:00</updated><author><name>ddaa</name></author><id>tag:ddaa.tw,2018-08-18:/defcon_26_other_summary.html</id><summary type="html">&lt;p&gt;稍微紀錄一下 DEF CON 26 CTF 這幾天的事情...&lt;br&gt;
有些情況是睡醒之後聽大家轉述的，如果有誤還麻煩指證 XD&lt;/p&gt;
&lt;hr&gt;
&lt;h2&gt;Day 0&lt;/h2&gt;
&lt;p&gt;趕工封包分析工具，寫出各種 bug ... 早知道前幾天就少玩一點 switch 了 XD&lt;/p&gt;
&lt;p&gt;其中最麻煩的 bug 是發現封包如果時間非常接近時有 race condition 的問題，先發生的測試會被覆寫成同一次結果，搞東搞西弄到早上快五點才讓工具能正常工作 Orz&lt;/p&gt;
&lt;p&gt;&lt;img alt="switch.jpg" src="https://ddaa.tw/images/defcon_26_switch.jpg"&gt;&lt;/p&gt;
&lt;h2&gt;Day 1&lt;/h2&gt;
&lt;p&gt;唯一下去會場的一天，一開始現場網路大爆炸，對外網路 1800ms 的延遲 XDD 比賽延後一小時開始，預料之內的因為主辦方更換，規則也跟著有所變動：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Attack &amp;amp; Defense 的算分不再是零和制&lt;/li&gt;
&lt;li&gt;Attack point 打多少隊伍就得多少分&lt;/li&gt;
&lt;li&gt;Defense point 有成功擋住攻擊會獲得分數&lt;ul&gt;
&lt;li&gt;不太確定到底是怎麼判斷成功防禦，主辦方到第三天才把分數算對...應該算對了吧 …&lt;/li&gt;&lt;/ul&gt;&lt;/li&gt;&lt;/ul&gt;</summary><content type="html">&lt;p&gt;稍微紀錄一下 DEF CON 26 CTF 這幾天的事情...&lt;br&gt;
有些情況是睡醒之後聽大家轉述的，如果有誤還麻煩指證 XD&lt;/p&gt;
&lt;hr&gt;
&lt;h2&gt;Day 0&lt;/h2&gt;
&lt;p&gt;趕工封包分析工具，寫出各種 bug ... 早知道前幾天就少玩一點 switch 了 XD&lt;/p&gt;
&lt;p&gt;其中最麻煩的 bug 是發現封包如果時間非常接近時有 race condition 的問題，先發生的測試會被覆寫成同一次結果，搞東搞西弄到早上快五點才讓工具能正常工作 Orz&lt;/p&gt;
&lt;p&gt;&lt;img alt="switch.jpg" src="https://ddaa.tw/images/defcon_26_switch.jpg"&gt;&lt;/p&gt;
&lt;h2&gt;Day 1&lt;/h2&gt;
&lt;p&gt;唯一下去會場的一天，一開始現場網路大爆炸，對外網路 1800ms 的延遲 XDD 比賽延後一小時開始，預料之內的因為主辦方更換，規則也跟著有所變動：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Attack &amp;amp; Defense 的算分不再是零和制&lt;/li&gt;
&lt;li&gt;Attack point 打多少隊伍就得多少分&lt;/li&gt;
&lt;li&gt;Defense point 有成功擋住攻擊會獲得分數&lt;ul&gt;
&lt;li&gt;不太確定到底是怎麼判斷成功防禦，主辦方到第三天才把分數算對...應該算對了吧?&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;除了 A&amp;amp;D 以外也同時有 King of the Hill 的題目，前五名就會分別獲得 10, 6, 3, 2, 1 分&lt;ul&gt;
&lt;li&gt;個人覺得這樣的配分比較理想，大家不會因為第一名領先太多而放棄 KoH 的題目。&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;禁止 access 到 gamebox，也不能連到其他隊伍的網路&lt;/li&gt;
&lt;li&gt;每題隨著 exploit 的數量而有不同的狀態，由好到壞的順序是 &lt;strong&gt;GOOD&lt;/strong&gt;-&amp;gt; &lt;strong&gt;LOW&lt;/strong&gt; -&amp;gt; &lt;strong&gt;BAD&lt;/strong&gt; -&amp;gt; &lt;strong&gt;INACTIVE&lt;/strong&gt;，變成 &lt;strong&gt;INACTIVE&lt;/strong&gt; 就不能再打了&lt;ul&gt;
&lt;li&gt;大家可以根據題目的狀態評估這題的投資報酬率，個人覺得這個設計還不錯&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img alt="status.png" src="https://ddaa.tw/images/defcon_26_status.png"&gt;&lt;/p&gt;
&lt;p&gt;原本要寫自動抓 pcap 並根據 service 分割後分類保存的 script，結果今年規則 pcap 會到 service 快被打爛才給......XDD 頓時沒事情做，同時宣告昨晚的封包分析工具幾乎做白工了 = = BTW，後來 lsc 抽空把 script 寫完了 &amp;lt;(_ _)&amp;gt; 大家讀完規則心情都不太美麗，因為之前趕工的 tool 幾乎沒有用武之地了 Q__Q&lt;/p&gt;
&lt;p&gt;取得 pcap 的管道是從 web 頁面下載，不像往年是從 sftp 下載，用 web 我是沒意見，但為什麼不另外做一頁來讓大家載 pcap = =&lt;/p&gt;
&lt;p&gt;&lt;img alt="pcap.png" src="https://ddaa.tw/images/defcon_26_pcap.png"&gt;&lt;/p&gt;
&lt;p&gt;開賽後放出一道 KoH 的題目 &lt;code&gt;reverse&lt;/code&gt;，下載 binary 執行後發現是一個 cloze 問答遊戲，題目會將 assembly 的片段挖空，要從選項回答正確的答案，但後來發現選項有重複甚至根本答案是錯的...= = 嘗試 reverse 並 patch 程式，但 server 端有檢查數據而行不通。&lt;/p&gt;
&lt;p&gt;後來大致可分兩組人馬用不同方式解這題：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Parse output 組 (sean &amp;amp; david942j)&lt;/li&gt;
&lt;li&gt;Reverse protocol 組 (lays &amp;amp; jery 和樓上其他人?)&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;我嘗試用 gdbscript hook 處理 output 的 function，再 parse 題目自動解題，但後來發現進度落後其他人，就沒有繼續嘗試了。&lt;/p&gt;
&lt;p&gt;下午放出新題 &lt;code&gt;pointless&lt;/code&gt;，binary 是 mips 的架構，連上去之後得到了一些 base64 的字串，解回來是一個很大的數字，初步猜測是 crypto 相關的題目。&lt;/p&gt;
&lt;p&gt;原本想丟到 &lt;a href="https://retdec.com/"&gt;RetDec&lt;/a&gt; 做 decompile，但發現 online service 已經關了，改成 open source 讓大家自己用工具處理，裝了一下 ida plugin 覺得難用，就倚賴 orange 和 jery 幫忙 decompile，一開始解出的 code 有幾十萬行...根本不能看 = =，後來把 gmpz 的 library 餵進去之後，剩下 4000 餘行，大家比較能開始找洞在哪。&lt;/p&gt;
&lt;p&gt;待到下午四點左右實在撐不住了，先回樓上睡覺，睡醒得知有放兩道新題 &lt;code&gt;doublethink&lt;/code&gt; 和 &lt;code&gt;twoplustwo&lt;/code&gt;，jery 已經發現 &lt;code&gt;pointless&lt;/code&gt; 一個 &lt;code&gt;memcpy&lt;/code&gt; 的漏洞，但因為前面的 crypto 沒辦法解，所以還是不能串整個 exploit，大家跟 lyc12345 遠端討論了一下 RSA 要如何破，但因為飯店網路有問題沒辦法好好的寫 code 測試。&lt;/p&gt;
&lt;p&gt;DEFKOR00T 打出 &lt;code&gt;twoplustwo&lt;/code&gt; 的 firstblood，david942j 有發現漏洞但是還沒辦法成功利用。  &lt;/p&gt;
&lt;p&gt;PPP 已經成功打出 &lt;code&gt;pointless&lt;/code&gt; 的 firstblood，據說得知主辦方出包跑的題目是 x64 的版本，也因為這樣我們猜測一定還有一個能讀 flag 的邏輯洞，否則 PPP 不太可能成功打下 XD&lt;/p&gt;
&lt;p&gt;晚餐時間發生了小插曲，要用 ubereat 定麥當勞當晚餐，angelboy 原本想訂麥克雞塊套餐，結果點到快樂兒童餐，而且有一票人喊 +1，大家因此得到了好幾個 Mario Odyssey 的玩具 XDDD&lt;/p&gt;
&lt;p&gt;&lt;img alt="mcdonalds.jpg" src="https://ddaa.tw/images/defcon_26_mcdonalds.jpg"&gt;&lt;/p&gt;
&lt;h2&gt;Day 2&lt;/h2&gt;
&lt;p&gt;晚上大家分成三組解 &lt;code&gt;pointless&lt;/code&gt;、&lt;code&gt;twoplustwo&lt;/code&gt; 和 &lt;code&gt;doublethink&lt;/code&gt;，&lt;code&gt;pointless&lt;/code&gt; 看一陣子之後覺得幫不上忙，決定改去解 &lt;code&gt;doublethink&lt;/code&gt;。&lt;/p&gt;
&lt;p&gt;&lt;code&gt;doublethink&lt;/code&gt; 也是 KoH 的題目，規則是上傳一份 shellcode，能同時跑在越多架構上則獲得越高分，一共有 14 個平台，分成 present, past, future 三類：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;past&lt;ul&gt;
&lt;li&gt;lgp-30&lt;/li&gt;
&lt;li&gt;pdp-1, pdp-8, pdp-10&lt;/li&gt;
&lt;li&gt;mix&lt;/li&gt;
&lt;li&gt;ibm-1401&lt;/li&gt;
&lt;li&gt;nova&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;present&lt;ul&gt;
&lt;li&gt;amd64&lt;/li&gt;
&lt;li&gt;arm64&lt;/li&gt;
&lt;li&gt;mipsel&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;future&lt;ul&gt;
&lt;li&gt;risc-v&lt;/li&gt;
&lt;li&gt;hexagon&lt;/li&gt;
&lt;li&gt;mmix&lt;/li&gt;
&lt;li&gt;clemency&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;雖然有 14 個平台，但 present 只能選一個來跑，因此理論上最多可以拿到 12 分。&lt;/p&gt;
&lt;p&gt;review 完主辦方給的環境後，發現每次 shellcode 在執行的環境沒有互相隔離，amd64 拿來跑 shellcode 的 binary 也沒有任何的防護，推測是可以拿 shell 來做一些壞事，但因為有降權成 &lt;code&gt;nobody&lt;/code&gt;，一開始沒有看到什麼明顯的問題。&lt;/p&gt;
&lt;p&gt;後來 jeffxx 發現 past 系列都會將 instruction pipe 給 simulator 執行，推測這邊有 race condition 的問題，可以 hijack fd 來影響 output，摸索了一陣子成功做出 POC，證明 jeffxx 的猜測正確。&lt;/p&gt;
&lt;p&gt;最後分的 exploit 分成三個人完成：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;sean 負責串 present 和 future 的 polyglot shellcode，成功串了 &lt;code&gt;amd64&lt;/code&gt;+&lt;code&gt;risc-v&lt;/code&gt;+&lt;code&gt;hexagon&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;jeffxx 將 POC 改寫成可以穩定觸發 race condition 的 shellscript&lt;/li&gt;
&lt;li&gt;我負責把 POC 寫成不需要透過 reverse shell 就能執行 shell script 的版本&lt;ul&gt;
&lt;li&gt;有過今年 SECCON final 前車之鑑，現在寫 exploit 都盡可能寫成不需要 reverse shell 的版本，後來證明改寫是必要的...&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;因為沒注意到 service.py 會執行 killall 的問題，debug 很久才確認沒辦法跑一份 shellscript 就 hijack 全部 past 架構，完成時已經接近早上八點吃早餐的時間了，BTW，優等生 twoplustwo 組很早就完成 exploit 然後先去睡了，羨慕阿~~&lt;/p&gt;
&lt;p&gt;隔天開賽主辦方又出包了...XD，A&amp;amp;D 推遲到中午才開始，KoH 早一點，11 點就可以開打，昨晚精心撰寫的 exp 成功的打下了 11 個平台...才怪，一開始沒有成功打出 exploit，只能眼看著 Dragon Sector 成功打出 9 個 exploit Orz&lt;/p&gt;
&lt;p&gt;如昨晚預期的可能沒有 reverse shell 可以用，暗自慶幸有熬夜改寫成寫檔的版本，但寫檔的版本也沒有成功打下 11 個平台...。&lt;/p&gt;
&lt;p&gt;原本以為是主辦方的環境有禁止寫檔，要改寫成純 assembly 的版本，但越想越不對勁，於是先用 open+write 再用 sendfile 確認寫檔是否能成功，結論是有成功寫檔，但是一直噴出重複的內容，猜測是重複執行寫檔了，至今還是不曉得為什麼會造成這種情況...由於寫檔會一直 loop，可想而知 shellscript 的內容也重複了，正在思考如何改寫時，bruce30262 神來一筆說直接在最後插 &lt;code&gt;exit&lt;/code&gt; 就好了，真是睿智 XD&lt;/p&gt;
&lt;p&gt;在經歷一番波折後成功的打下了 11 個平台，一開始主辦方不知道為何沒吃到紀錄...，打了第二次才成功將記錄更新，話說因為最後 exploit 要各平台手動執行，在打名稱時手都抖抖的很怕自己打錯就要重來了 XDDD&lt;/p&gt;
&lt;p&gt;&lt;img alt="doublethink_rank.jpg" src="https://ddaa.tw/images/defcon_26_doublethink_rank.jpg"&gt;&lt;/p&gt;
&lt;p&gt;同時 A&amp;amp;D 的狀況似乎不太樂觀，&lt;code&gt;pointless&lt;/code&gt; 因為 mips 跑得太慢，攻擊很容易打不成功，而 &lt;code&gt;twoplustwo&lt;/code&gt; 因為洞太簡單，大部分的隊伍已經補上，也沒有成功拿到多少分數......，確認 &lt;code&gt;doublethink&lt;/code&gt; 穩定拿分，而且 sean 暫時沒有想串 clememcy 的念頭我就先去睡了。&lt;/p&gt;
&lt;p&gt;睡覺的途中放了新題 &lt;code&gt;oooeditor&lt;/code&gt; 和 &lt;code&gt;poool&lt;/code&gt;，&lt;code&gt;oooeditor&lt;/code&gt; 在我還神志不清的時候大家就解掉了 &amp;lt;(_ _)&amp;gt; 沒多久 &lt;code&gt;oooeditor&lt;/code&gt; 的洞幾乎全世界都補上，主辦方放出 pcap 時根本沒用了 = = 這題的狀態也很快就變成 &lt;strong&gt;INACTIVE&lt;/strong&gt;，大概是壽命最短暫的一題了，&lt;code&gt;poool&lt;/code&gt; 是關於 blockchain 的題目，這領域我不太拿手，打開稍微看一下就沒繼續深追了，沒多久 DEFKOR00T 成功打出了 firstblood ... 由衷佩服他們挖掘漏洞的速度 Orz&lt;/p&gt;
&lt;p&gt;沒多久又放了新題 &lt;code&gt;bew&lt;/code&gt;，是由 node.js 架設的 web 服務，能 patch 的檔案是 web assembly，建設 docker 時發現 npm 有噴 &lt;code&gt;express-validator&lt;/code&gt; 這個套件的 security issue，但看了一下是用來做 DoS 的，估計是沒什麼用，我們還在傻傻的看 wasm 的時候，orange 成功黑箱踹出可以 js injection，沒多久就成功拿到 flag，可惜 PwnThyBytes 更早了一些，沒成功拿到 firstblood QQ。由於這題的 payload 會直接被記在 web 的某個頁面上，這題大家很快就打得滿天飛了，大家研究了很久該如何 patch，最後發現 wasm 裡面的 &lt;code&gt;eval&lt;/code&gt; 不是觸發 injection 的點，orange 寫了一個簡易的 waf 阻止被攻擊，貌似有成功防禦當時大家的 payload ... 但後來他自己想到繞過的方式了 XDD&lt;/p&gt;
&lt;p&gt;&lt;img alt="bew.png" src="https://ddaa.tw/images/defcon_26_bew.png"&gt;&lt;/p&gt;
&lt;p&gt;第二天結束前放了新題 &lt;code&gt;vchat&lt;/code&gt;，另外由於開賽 delay，第二天延到 21:00 才結束，主辦方宣布了一些事項，其中比較重要的是他們發現 Defense point 有算錯，明天會將修正後的分數公佈，在等待晚餐到來之際，手機陸續收到了沙塵暴和大洪水的災難通知 XDDD，只能感謝 turkey 和 alan 在這種天氣下幫我們張羅晚餐 &amp;lt;(_ _)&amp;gt;，晚餐是好吃的中式餐館，可以排名今年來 Les Vegas 前三好吃的食物 XD。&lt;/p&gt;
&lt;h2&gt;Day 3&lt;/h2&gt;
&lt;p&gt;晚上也是分成三組在看題目，分別是 &lt;code&gt;poool&lt;/code&gt;、&lt;code&gt;bew&lt;/code&gt; 和 &lt;code&gt;vchat&lt;/code&gt;，考慮了一下決定看新題 &lt;code&gt;vchat&lt;/code&gt;，投資報酬率應該會比較高(後來證明大錯特錯...)。&lt;/p&gt;
&lt;p&gt;題目給了兩個檔案 &lt;code&gt;vchat&lt;/code&gt; 和 &lt;code&gt;vbot&lt;/code&gt;，前者只是一個 shellscript 來執行 &lt;code&gt;vbot&lt;/code&gt;，後者是一個 binary，觀察了一陣行為得知是 xmpp 協定的 client，嘗試裝了各種 open source 的 server 都沒辦法好好的跟 &lt;code&gt;vbot&lt;/code&gt; 互動，後來在 jeffxx 神一樣的通靈之下，理解到原來 &lt;code&gt;vbot&lt;/code&gt; 會以 anonymous 的身分登入，因此要讓 &lt;code&gt;vbot&lt;/code&gt; 主動跟我們的 client 聯繫，我們才有辦法得知 id 並傳送指令，至此已經接近凌晨 3 點了...。&lt;/p&gt;
&lt;p&gt;接著分頭進行逆向和撰寫 client，但竟然找不到一個文件齊全的 library 使用，一直卡在 anonymous 認證這邊不曉得怎麼處理，後來 jeffxx 跟 meh 決定直接用題目用的 gloox 來寫 client XD&lt;/p&gt;
&lt;p&gt;到早上六點 client 基本上可以動了，但找不到洞在哪... 我一度以為處理 QRcode 的地方會 heap overflow，但其實不會，base64 疑似有 off-by-one 的漏洞，但是在保護全開又沒辦法正常 leak 的情況下似乎不太能利用，就這樣抱著會被其他隊伍打爆的心情開賽了，結果竟然風平浪靜，沒有隊伍看出問題在哪，另外主辦方在設置環境時就先給了 &lt;code&gt;vchat-hint.tgz&lt;/code&gt; ...，解開後發現是 server 和 client 的 Dockerfile，眾人猜測是昨天忘記附上...... 有了 server 昨天至少可以省下兩小時的時間 = =&lt;/p&gt;
&lt;p&gt;第三天秀了一下修正 Defense point 的結果，我們似乎上升到了第三名，接著就如往年的慣例不再顯示記分板，但聽說偶爾會顯示匿名的戰況。&lt;/p&gt;
&lt;p&gt;&lt;code&gt;bew&lt;/code&gt; 這題遇到跟 &lt;code&gt;pointless&lt;/code&gt; 差不多的慘劇，打了幾輪之後發現有隊伍開始 DoS 服務，patch 系統也發生問題，沒辦法把 atdog 昨晚精心設計的 patch 給傳上去，甚至發生之前傳的 ok，但重傳一次就變成 &lt;strong&gt;SLA FAIL&lt;/strong&gt; 的慘況，過沒多就這題就關了。&lt;/p&gt;
&lt;p&gt;&lt;img alt="patch.jpg" src="https://ddaa.tw/images/defcon_26_patch.jpg"&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;poool&lt;/code&gt; 開賽打出非常好的效果，一開始約莫可以打 20 隊左右，猜測是因為主辦方今天突然宣布只能 patch 100 byte，大家昨晚的 patch 沒辦法成功上傳的原因 XD 唯一可惜的是一開賽 &lt;code&gt;poool&lt;/code&gt; 的狀態就是 &lt;strong&gt;LOW&lt;/strong&gt;，過一陣子又變成 &lt;strong&gt;BAD&lt;/strong&gt; 了，否則應該應該可以賺更多分數。&lt;/p&gt;
&lt;p&gt;開賽後沒多久放了新題目 &lt;code&gt;reeducation&lt;/code&gt;，是個 rust 的執行檔，果斷放生 &lt;code&gt;vchat&lt;/code&gt; 來看這題，對 rust 逆向不甚熟悉，還好有 jery 在旁可以詢問，用手動亂 fuzz 有發現 input 要超過 1024 byte 才會觸發執行失敗的錯誤訊息，後來又發現餵 non-printable 可以戳出 out-of-bound 的 exception，但沒看出有哪邊可以利用。&lt;/p&gt;
&lt;p&gt;過一陣子 DEFKOR00T 又打出了 firstblood，後來許多隊伍也開始打出攻擊，但我們遲遲沒辦法找到問題 Q__Q 一直到結束前一小時才發現是個很簡單的 out-of-bound 漏洞.....，主辦方原本要放出 pcap，但卻忘記錄流量，直到我們去反應才發現，沒多久就成功 replay 了 (因為洞真的很簡單)，主辦方似乎對我們沒找到這麼簡單的問題感到驚訝...Orz&lt;/p&gt;
&lt;p&gt;在結束前我也成功寫完了可以 leak flag 的 exploit，但為時已晚，大家很擔心會因為這題而被翻盤，順帶一提這題只能 patch 16 byte，在發現問題後 jery patch 了 13 byte 的版本並上傳，卻顯示 &lt;strong&gt;TOO MANY BYTE&lt;/strong&gt; ... XDDD&lt;/p&gt;
&lt;p&gt;在我因為 &lt;code&gt;reeducation&lt;/code&gt; 焦頭爛額時，主辦方也放了最後一題 KoH &lt;code&gt;propaganda&lt;/code&gt;，只有大概了解是一個比用最少 byte patch 程式的題目，我們似乎一直在第五名左右徘徊，這題應該是唯一一題我完全沒有看過的題目。&lt;/p&gt;
&lt;p&gt;賽後跟大家一起發送鳳梨酥給各隊伍，跟其他隊伍交流了一下題目的做法，也炫耀 (?) 了一下 &lt;code&gt;doublethink&lt;/code&gt; 是怎麼做到 11 個平台的 XD，Dragon Sector 果然也是用同一招解的，PPP 串了八個平台跟神一樣...，BFS 也串了五個平台，而且還是分兩邊進行再接在一起，也是滿不簡單的 XDD&lt;/p&gt;
&lt;p&gt;&lt;code&gt;vchat&lt;/code&gt; 的洞聽說是跟 gloox 有關，老實說有猜到洞可能會是不當使用 library，但比較把心思花在各個指令的功能上，沒有認真的把處理 xmpp 的邏輯看一遍，早知道應該放棄 &lt;code&gt;vchat&lt;/code&gt; 早點睡覺，&lt;code&gt;reeducation&lt;/code&gt; 應該就不會沒看到那個廢洞了 QQ&lt;/p&gt;
&lt;p&gt;賽後交流的期間主辦方把 DEFKOR00T、PPP 還有 HITCON 的隊長叫過去集合，說等等頒獎時務必要到場，大概就猜到應該有前三名了，閉幕儀式跟往年一樣整個睡死，途中換個姿勢睡，結果一睜眼就有一顆球飛過來 = = 順手擋了一下球又往後面飛去了，不知道後來被玩到哪去了 XDD 今年是第一次讓前三名上台領獎，過往都只有第一名上台而已，可惜我不太上相...QQ&lt;/p&gt;
&lt;p&gt;&lt;img alt="award.jpg" src="https://ddaa.tw/images/defcon_26_award.jpg"&gt;&lt;/p&gt;
&lt;p&gt;結束跟去年一樣吃 Caesar 的 buffet，螃蟹腳吃到飽就是爽 (?) angelboy 也太會剝螃蟹了吧 = = 吃完跟 jeffxx、lsc、lays 去賭輪盤，jeffxx 沒多久就輸光退場了，我接著也輸光退場 QQ Lays 原本也要輸光了，結果連續梭兩次從 $10 變成 $40，有夠扯...= = lsc 還在各種奮戰，但 after party 的時間到了，就先回房間跟其他人會合會合一起過去，房間在玩 Overcooked，四個人玩到快要吵架了...XDDD&lt;/p&gt;
&lt;p&gt;&lt;img alt="crab.jpg" src="https://ddaa.tw/images/defcon_26_crab.jpg"&gt;&lt;/p&gt;
&lt;p&gt;after party 是 OOO 提供的總統套房，有超大電視螢幕、兩層樓、撞球桌和疑似廚房的空間，真的猛，但即使這麼大的空間場地還是被塞爆了，現場可能有快 100 人吧 = = 今年好像沒有 PCTF 的衣服好拿，只好改拿 shellphish 的衣服，現場人實在是太多了，只有跟 TokyoWesterns 和 Shellphish 的成員聊到天，沒多久就回去行政套房加入 switch party 的行列了 XD&lt;/p&gt;
&lt;p&gt;&lt;img alt="after_party.jpg" src="https://ddaa.tw/images/defcon_26_after_party.jpg"&gt;&lt;/p&gt;
&lt;h2&gt;後記&lt;/h2&gt;
&lt;p&gt;今年的 DEF CON CTF 因為 infrastructure 不穩定，大家還滿困擾的，但題目本身的品質還不錯，幾題 KoH 大家都玩得很盡興，尤其是 &lt;code&gt;doublethink&lt;/code&gt;，在撰寫這篇文章時已經看到有串 9 個平台的版本了...真的是太瘋狂了 XD 還好主辦方最後允許用 race condition 的方式做題，否則今年能不能保住前三名實在難說 QQ&lt;/p&gt;
&lt;p&gt;開始工作之後解 jeopardy 的能力大幅下滑了 QQ 稍微難一點的 pwn 題都要想很久才有辦法解，如果比較新的 trick 就更不會了 T__T 但這兩年打 DEF CON CTF 反而做出比較多的貢獻，大概是基礎能力全面提升了吧? 今年的 &lt;code&gt;doublethink&lt;/code&gt; 應該是我寫過的 exploit 裡面拿最多分的一次了，爽 XD&lt;/p&gt;
&lt;p&gt;&lt;img alt="doublethink_result.jpg" src="https://ddaa.tw/images/defcon_26_doublethink_result.jpg"&gt;&lt;/p&gt;
&lt;p&gt;不知不覺也打 CTF 5 年了，但對 real world 的漏洞挖掘還是沒有什麼突破 Q__Q 還要更加努力阿...！&lt;/p&gt;
&lt;p&gt;最後放張 jery 難得有入鏡的大合照做結尾 XD&lt;/p&gt;
&lt;p&gt;&lt;img alt="our_photo.jpg" src="https://ddaa.tw/images/defcon_26_our_photo.jpg"&gt;&lt;/p&gt;</content><category term="DEF CON CTF"></category></entry><entry><title>DEF CON 22 CTF Final summary</title><link href="https://ddaa.tw/defcon_other_summary.html" rel="alternate"></link><published>2014-08-13T18:34:00+08:00</published><updated>2014-08-13T18:34:00+08:00</updated><author><name>ddaa</name></author><id>tag:ddaa.tw,2014-08-13:/defcon_other_summary.html</id><summary type="html">&lt;p&gt;&lt;strong&gt;===WARNING===&lt;/strong&gt;
這篇文章廢話超多......&lt;br&gt;
若要看比賽細節請直接跳至 &lt;strong&gt;8/8&lt;/strong&gt;  &lt;/p&gt;
&lt;hr&gt;
&lt;h2&gt;8/5&lt;/h2&gt;
&lt;hr&gt;
&lt;p&gt;必須說這次的出國真的很刺激&lt;br&gt;
首先是 orange 的簽證填錯護照號碼 XD&lt;br&gt;
過安檢的時候 jery 背包的一堆給溪都被丟掉了&lt;br&gt;
到 SFO 之後 sean 和 jery 過海關時不知為何被攔下&lt;br&gt;
好險長榮的工作人員去解圍&lt;br&gt;
經過一番波折終於抵達 las vegas&lt;br&gt;
在搭機場到飯店的接駁車上&lt;br&gt;
深深為 strip 的夜景感到驚豔  &lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;TT: 就是 unix 那個 strip  &lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;可惜相機還放在行李箱裡 Orz&lt;br&gt;
抵達飯店 RIO 以後跟 GD 會合&lt;br&gt;
在等待 checkin 的時間把一樓賭場逛了逛&lt;br&gt;
有種劉姥姥進大觀園的感覺~&lt;br&gt;
回飯店放完行李就出發覓食&lt;br&gt;
最後吃了漢堡王...好貴&lt;br&gt;
不過份量也很大 …&lt;/p&gt;</summary><content type="html">&lt;p&gt;&lt;strong&gt;===WARNING===&lt;/strong&gt;
這篇文章廢話超多......&lt;br&gt;
若要看比賽細節請直接跳至 &lt;strong&gt;8/8&lt;/strong&gt;  &lt;/p&gt;
&lt;hr&gt;
&lt;h2&gt;8/5&lt;/h2&gt;
&lt;hr&gt;
&lt;p&gt;必須說這次的出國真的很刺激&lt;br&gt;
首先是 orange 的簽證填錯護照號碼 XD&lt;br&gt;
過安檢的時候 jery 背包的一堆給溪都被丟掉了&lt;br&gt;
到 SFO 之後 sean 和 jery 過海關時不知為何被攔下&lt;br&gt;
好險長榮的工作人員去解圍&lt;br&gt;
經過一番波折終於抵達 las vegas&lt;br&gt;
在搭機場到飯店的接駁車上&lt;br&gt;
深深為 strip 的夜景感到驚豔  &lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;TT: 就是 unix 那個 strip  &lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;可惜相機還放在行李箱裡 Orz&lt;br&gt;
抵達飯店 RIO 以後跟 GD 會合&lt;br&gt;
在等待 checkin 的時間把一樓賭場逛了逛&lt;br&gt;
有種劉姥姥進大觀園的感覺~&lt;br&gt;
回飯店放完行李就出發覓食&lt;br&gt;
最後吃了漢堡王...好貴&lt;br&gt;
不過份量也很大&lt;br&gt;
大家對蘑菇醬很有話題...XDD&lt;br&gt;
&lt;img alt="IMG_1733.JPG" src="http://user-image.logdown.io/user/6149/blog/6156/post/220500/WBrjgcYzQoSJ7dOIROZK_IMG_1733.JPG"&gt;&lt;/p&gt;
&lt;p&gt;吃完去賭場逛逛&lt;br&gt;
大家玩了幾次吃角子老虎&lt;br&gt;
輸一點小錢就回房間洗洗睡&lt;br&gt;
因為網路要另外收錢 = =&lt;br&gt;
順便抱怨飯店的提供的肥皂和洗髮精真的很難用&lt;br&gt;
我有點皮膚過敏的反應 orz&lt;br&gt;
&lt;img alt="IMG_1734.JPG" src="http://user-image.logdown.io/user/6149/blog/6156/post/220500/lE6XqYfnTeuUtH8tPf4Y_IMG_1734.JPG"&gt;  &lt;/p&gt;
&lt;h2&gt;8/6&lt;/h2&gt;
&lt;hr&gt;
&lt;p&gt;如果不算昨天，今天是到 las vegas 的第一天&lt;br&gt;
其實感覺不到什麼時差&lt;br&gt;
睡到大約九點&lt;br&gt;
發現 jeffxx 等人早就起床去吃過早餐了&lt;br&gt;
其他人也就集合下去吃&lt;br&gt;
一部分的人吃 starbucks&lt;br&gt;
其他人又去吃漢堡王 XDD&lt;br&gt;
starbucks 好貴 ...&lt;br&gt;
$11 ... 應該是我生平吃過最貴的早餐了  &lt;/p&gt;
&lt;p&gt;吃完早餐有些人就回去調時差&lt;br&gt;
其他人各自做自己的事情&lt;br&gt;
等到下午大家開始整合事前準備&lt;br&gt;
由於賽前無法得知規則及環境&lt;br&gt;
大家盡可能的推演各種狀況&lt;br&gt;
並分成 &lt;strong&gt;wrapper&lt;/strong&gt; 和 &lt;strong&gt;script&lt;/strong&gt; 兩組&lt;br&gt;
分配工作給大家&lt;br&gt;
兩組的工作主要有：  &lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;wrapper (seau jery peter shik lucas)&lt;/li&gt;
&lt;li&gt;pty&lt;/li&gt;
&lt;li&gt;socket&lt;/li&gt;
&lt;li&gt;ld_preload &lt;/li&gt;
&lt;li&gt;ptrace&lt;/li&gt;
&lt;li&gt;script (orange jeffxx atdog dm4 and me)&lt;/li&gt;
&lt;li&gt;backdoor&lt;/li&gt;
&lt;li&gt;backup token &amp;amp; log&lt;/li&gt;
&lt;li&gt;monitor dir, port, ... etc&lt;/li&gt;
&lt;li&gt;parse pcap&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;除此之外還有模擬 gamebox 環境&lt;br&gt;
由 orange 和 jery 負責&lt;br&gt;
討論完後大家就各自工作&lt;br&gt;
其餘的時間除了吃 buffet 以外&lt;br&gt;
就是各自工作&lt;br&gt;
buffet 味道還不錯&lt;br&gt;
不過柳橙汁超酸&lt;br&gt;
中途大家要發表一下賽前心得...&lt;br&gt;
超難的 我已經不記得自己講什麼了 = =&lt;br&gt;
吃完原本打算去賭場浪費 $$&lt;br&gt;
結果才坐下來就被保安檢查&lt;br&gt;
我沒帶證件就被趕回房間了 QQ&lt;br&gt;
把一些 script 做細微修改&lt;br&gt;
剩下的時間研究去年 blue-lotus 的心得和去年 defcon 規則&lt;br&gt;
&lt;img alt="IMG_1757.JPG" src="http://user-image.logdown.io/user/6149/blog/6156/post/220500/IJ1AfSDFRduOKnyl14Je_IMG_1757.JPG"&gt;  &lt;/p&gt;
&lt;h2&gt;8/7&lt;/h2&gt;
&lt;hr&gt;
&lt;p&gt;早上 alan 幫大家準備的早點&lt;br&gt;
吃一吃不知道誰提議要吃泡麵&lt;br&gt;
我帶的熱水壺就派上用場 XD&lt;br&gt;
吃完原本以為是要去樓下聽規則&lt;br&gt;
結果只是領取 badge 和一些大會贈品&lt;br&gt;
badge 是一塊...開發板 ?&lt;br&gt;
裡面似乎可以編寫自己的功能&lt;br&gt;
還有一些奇怪的模組 XD&lt;br&gt;
我對硬體不熟就沒研究了&lt;br&gt;
沒多久 alan 買完其他人的 badge&lt;br&gt;
大概有 20 幾個 ... 超扯 XD&lt;br&gt;
&lt;img alt="IMG_1766.JPG" src="http://user-image.logdown.io/user/6149/blog/6156/post/220500/Q6WB6yoSSTSIpK7eFW7y_IMG_1766.JPG"&gt;  &lt;/p&gt;
&lt;p&gt;接著我們下去買紀念 t-shirt 的攤位&lt;br&gt;
一路上都是排隊買票的隊伍&lt;br&gt;
長度快要突破天際啦~~~&lt;br&gt;
&lt;img alt="IMG_1770.JPG" src="http://user-image.logdown.io/user/6149/blog/6156/post/220500/0xO4c4xRQzWTtBvcJCrq_IMG_1770.JPG"&gt;&lt;br&gt;
到攤位才知道原來 t-shirt 有很多種&lt;br&gt;
樣式還滿好看的 不輸西門町一些潮T&lt;br&gt;
最有看頭的是白色醫生袍 XDDD&lt;br&gt;
穿上去實在很酷&lt;br&gt;
不過如果平常穿可能恥力要夠 XD&lt;br&gt;
因為帶的錢不夠&lt;br&gt;
只好先買了一件外套和 t-shirt&lt;br&gt;
外套要 $60 樣式很普通&lt;br&gt;
材質感覺不錯 穿起來很舒服&lt;br&gt;
&lt;img alt="IMG_1773.JPG" src="http://user-image.logdown.io/user/6149/blog/6156/post/220500/MDiHWTHESwispnHRXdCM_IMG_1773.JPG"&gt;  &lt;/p&gt;
&lt;p&gt;下午去逛 outlet&lt;br&gt;
orange &amp;amp; alan &amp;amp; me 搭導演的車&lt;br&gt;
其他人就搭車前往&lt;br&gt;
逛了半天結果我只買一隻冰淇淋來吃 XD&lt;br&gt;
其他人都各自有收穫&lt;br&gt;
回程順便去中國超市幫忙採購明天的早餐&lt;br&gt;
看到很多台灣的商品&lt;br&gt;
結帳時店員也是來自台灣&lt;br&gt;
還跟 alan 要電話 XD&lt;br&gt;
&lt;img alt="IMG_1804.JPG" src="http://user-image.logdown.io/user/6149/blog/6156/post/220500/aMIkfF4QESjWNzS6DltI_IMG_1804.JPG"&gt;  &lt;/p&gt;
&lt;p&gt;等大家都回到飯店後&lt;br&gt;
對明天比賽的戰術最後討論&lt;br&gt;
基本上有：  &lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;檢查 gamebox 能用上的 wrapper&lt;/li&gt;
&lt;li&gt;上 wrapper&lt;/li&gt;
&lt;li&gt;上 script&lt;/li&gt;
&lt;li&gt;與外場 sync 資訊&lt;/li&gt;
&lt;li&gt;錯誤狀況 &amp;amp; SOP &lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;討論持續到晚上一點多大家才休息&lt;br&gt;
主要是 wrapper 組要做的事情真的很多&lt;br&gt;
他們甚至省下 outlet 的行程趕工&lt;br&gt;
太強大了 &amp;lt;(_ _)&amp;gt;  &lt;/p&gt;
&lt;h1&gt;8/8&lt;/h1&gt;
&lt;hr&gt;
&lt;p&gt;大家一大早就到樓下等著比賽開始&lt;br&gt;
看到很多之前只會在網路看到的隊伍&lt;br&gt;
感覺還滿奇妙的 XD&lt;br&gt;
大家進場後場外組和後援組就待在隔壁間&lt;br&gt;
透過事先建好的 ssh tunnel 操作&lt;br&gt;
我這邊負責建置的 script 沒遇到什麼問題&lt;br&gt;
ptrace 如預期的不能用&lt;br&gt;
wrapper 大部分都接了上去&lt;br&gt;
10 點正式開始&lt;br&gt;
開放兩個服務：&lt;code&gt;eliza&lt;/code&gt; and &lt;code&gt;wdub&lt;/code&gt;&lt;br&gt;
&lt;code&gt;eliza&lt;/code&gt; 簡單的說就是大航海時代宇宙版&lt;br&gt;
可以買賣東西賺錢這樣&lt;br&gt;
&lt;code&gt;wdup&lt;/code&gt; 是一個 http server&lt;br&gt;
不過由於只能透過 ctf.tw 存取&lt;br&gt;
沒有 browser 可用&lt;br&gt;
暫時就沒看這邊  &lt;/p&gt;
&lt;p&gt;一開始就不太順利&lt;br&gt;
&lt;strong&gt;wrapper 沒辦法通過主辦方的 service check&lt;/strong&gt;&lt;br&gt;
一開始就墊底 OTZ&lt;br&gt;
更慘的是 開賽兩小時後對外網路 gg&lt;br&gt;
&lt;strong&gt;帶來的 switch 對 vlan 999 的支援有問題&lt;/strong&gt;&lt;br&gt;
場內暫時用 4G 上網&lt;br&gt;
場外則完全無法連線&lt;br&gt;
還好 &lt;code&gt;eliza&lt;/code&gt; 是用 qemu 模擬 x86 的服務&lt;br&gt;
暫時還可以做離線分析&lt;br&gt;
這邊我試到可以控制 eip&lt;br&gt;
要開始寫 ROP 時&lt;br&gt;
場內也是進行到這步驟&lt;br&gt;
為了避免工作重疊就交給 sean 來寫 exploit&lt;br&gt;
在這邊我們場外組犯了一個錯誤&lt;br&gt;
&lt;strong&gt;看到 &lt;code&gt;wdup&lt;/code&gt; 有 html ， 一直以為&lt;code&gt;wdup&lt;/code&gt;是 web 題......&lt;/strong&gt;&lt;br&gt;
網路問題導至內外的資訊傳遞一直很緩慢&lt;br&gt;
一直到第二天快結束才反應過來&lt;br&gt;
超虧... &lt;code&gt;wdup&lt;/code&gt; 可能是我們掉最多分的一題  &lt;/p&gt;
&lt;p&gt;後來 GD 拿 thinkpad 接無線網卡暫時做為 router 使用&lt;br&gt;
讓場外組可以 access 內網 不過延遲很高...&lt;br&gt;
途中還有幾個突發狀況：  &lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;內外網全死，疑似是有隊伍做 dos，應該是透過 &lt;code&gt;eliza&lt;/code&gt;，cpu 使用率很高&lt;/li&gt;
&lt;li&gt;peter 和 shik 嘗試解 badge 題，結果在燒一次版子要兩分鐘，中間剛好 service check XDD&lt;/li&gt;
&lt;li&gt;lucas 透過分析封包時發現 &lt;code&gt;eliza&lt;/code&gt; 根本沒有 DEP，不過此時 sean 也差不多完成 ROP exploit 了&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;過一段時間又開了一題 &lt;code&gt;imap&lt;/code&gt;&lt;br&gt;
顧名思義就是可以做 imap protocol 的各種操作&lt;br&gt;
這題的 flag 位置跟其他題都不同&lt;br&gt;
猜測是 owner 為 root 資料夾底下有個特殊的檔案&lt;br&gt;
此外資料夾底下還有登入用的 password&lt;br&gt;
由於 tunnel 實在很 lag&lt;br&gt;
我只好在手機上用 gdb 去 reverse 這題&lt;br&gt;
lucas 有發現可疑的流量&lt;br&gt;
有其他隊伍直接就登入、讀 flag 並結束連線&lt;br&gt;
前面完全沒有獲得帳密的過程&lt;br&gt;
由於沒有備份 flag 很難確認到底是不是被攻擊了&lt;br&gt;
但我猜測應該並沒有被攻陷&lt;br&gt;
因為此流量的來源隊伍名次較後&lt;br&gt;
如果有成功拿 flag 不應該如此&lt;br&gt;
這流量的產生有兩個可能：  &lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;此主辦方的 service check&lt;/li&gt;
&lt;li&gt;此為其他隊伍混淆視聽的假流量&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;現在想想應該是第二個可能&lt;br&gt;
畢竟主辦方在有切 vlan 的情況下&lt;br&gt;
應該不會提供 service check 的流量  &lt;/p&gt;
&lt;p&gt;正當場外在研究 &lt;code&gt;imap&lt;/code&gt;時&lt;br&gt;
場內似乎發現有其他隊伍用 &lt;code&gt;eliza&lt;/code&gt; 的新漏洞來攻擊我們&lt;br&gt;
這個沒辦法透過 replay exploit 去獲得分數&lt;br&gt;
發生 exploit 需要遊戲金額到一定數量才能觸發&lt;br&gt;
物品和星球都是隨機生成&lt;br&gt;
所以必須先寫個自動賺錢外掛 XDD&lt;br&gt;
這邊就給 217 的 acm 大大去搞定  &lt;/p&gt;
&lt;p&gt;回到飯店後吃晚餐順便討論今天的戰況&lt;br&gt;
抱歉我完全不記得午餐和晚餐吃什麼.......OTZ&lt;br&gt;
比賽期間我們的名次在 4~8 名徘徊&lt;br&gt;
第一名由_韓國 ASRT_ 遙遙領先&lt;br&gt;
沒意外 &lt;code&gt;eliza&lt;/code&gt; 最早的 exploit 就是由他們寫出&lt;br&gt;
第二名則由 &lt;em&gt;men in blackhats&lt;/em&gt; 迎頭趕上&lt;br&gt;
第三名是 &lt;em&gt;ppp&lt;/em&gt;&lt;br&gt;
第四名 &lt;em&gt;blue-lotus&lt;/em&gt;&lt;br&gt;
我們暫居第五  &lt;/p&gt;
&lt;p&gt;討論完以後大家又繼續離線分析&lt;br&gt;
但是實在太累大家相繼睡去&lt;br&gt;
直到半夜又醒來解題 XDD&lt;br&gt;
dm4 給我了一個 &lt;code&gt;imap&lt;/code&gt; 可疑流量&lt;br&gt;
這次是真的可以 work !&lt;br&gt;
發現執行完 payload 以後&lt;br&gt;
可以用 &lt;code&gt;list&lt;/code&gt; 指令做任意路徑存取&lt;br&gt;
也就是可以得知使用者帳戶名稱及存放密碼的檔案&lt;br&gt;
由於密碼存放的資料夾和目錄是 666&lt;br&gt;
我瞬間念頭是可以透過其他 service 來存取這些檔案&lt;br&gt;
這個 payload 應該也只做到目前這樣&lt;br&gt;
後來 atdog 睡醒之後加入分析的行列&lt;br&gt;
眼尖的發現 payload 的檔名是用 &lt;code&gt;aaaaaaaaaaaaaaaaaaaaaaaaaaa../&lt;/code&gt;&lt;br&gt;
但是這樣的路徑根本不會 work XD&lt;br&gt;
原來這邊是一個 BOF 造成的邏輯漏洞&lt;br&gt;
突破盲點後很快我們找出 exploit 的位置&lt;br&gt;
並由 dm4 寫出攻擊的 script&lt;br&gt;
另一邊 &lt;code&gt;eliza&lt;/code&gt; 也成功賺到足夠的 $$ 並寫出 exploit  &lt;/p&gt;
&lt;h2&gt;8/9&lt;/h2&gt;
&lt;hr&gt;
&lt;p&gt;第二天一早要進場但是被擋在外面要排隊&lt;br&gt;
最後要由隊長拿 token 讓 8 個人進去&lt;br&gt;
因此外場組就只能在外面等&lt;br&gt;
今天 GD 嘗試解決 vlan 999 的問題&lt;br&gt;
可惜還是無解  &lt;/p&gt;
&lt;p&gt;今天得知主辦方計分方面有問題&lt;br&gt;
重算我們的排名上升到第二！&lt;br&gt;
後來記分板就關閉了 只顯示排名&lt;br&gt;
中午開了新題目 &lt;code&gt;justify&lt;/code&gt;&lt;br&gt;
&lt;em&gt;dragon sector&lt;/em&gt; 有送可疑流量過來&lt;br&gt;
但是仔細檢查後根本與程式流程無關&lt;br&gt;
而且流出的 flag 也 match 不上備份的&lt;br&gt;
差不多這時間我們突然第一名了 XD&lt;br&gt;
應該要歸功於前面成功攻擊放的後門  &lt;/p&gt;
&lt;p&gt;兩點左右發現 &lt;code&gt;justify&lt;/code&gt; 被打了&lt;br&gt;
不過內場後來說已經 patch&lt;br&gt;
但是這邊又有溝通上的問題 QQ&lt;br&gt;
外場大概很早有發現漏洞的確切位置&lt;br&gt;
但是以為內場已經 patch 而沒有告知&lt;br&gt;
回飯店才知道內場的 patch 是其他問題&lt;br&gt;
靠 wrapper 一開始有守下幾波&lt;br&gt;
不過 &lt;em&gt;ppp&lt;/em&gt; 的 payload 也一直進化&lt;br&gt;
五點的時候 &lt;code&gt;justify&lt;/code&gt; 突然爛掉&lt;br&gt;
還原成最初版本也沒用&lt;br&gt;
後來確認是主辦方的問題 XD  &lt;/p&gt;
&lt;p&gt;差不多三點左右 &lt;code&gt;wdup&lt;/code&gt; 換新版本&lt;br&gt;
由於沒人分析 又是一陣手忙腳亂&lt;br&gt;
只 wrapper 擋在前面避免大量失分&lt;br&gt;
靠著 replay 從弱隊獲得一些分數&lt;br&gt;
好像還有隊伍用其他 service 在 tmp 建 link&lt;br&gt;
來繞過 &lt;code&gt;wdup&lt;/code&gt; 的限制  &lt;/p&gt;
&lt;p&gt;接近六點的時候 &lt;code&gt;eliza&lt;/code&gt; 換成 arm 的版本&lt;br&gt;
不過程式似乎沒有做改動&lt;br&gt;
我們很快就把 jump 的漏洞給補上&lt;br&gt;
btw, patch 的部分都是靠 jery 負責&lt;br&gt;
真的很強大 &amp;lt;(_ _)&amp;gt;&lt;br&gt;
6:37 &lt;code&gt;imap&lt;/code&gt; 也放出了第二個版本&lt;br&gt;
外場第一時間把檔案抓下來比對&lt;br&gt;
由於 ctf.tw 無法連外&lt;br&gt;
只能轉成 hex 再用 copy &amp;amp; paste 的方式拉出來 ...&lt;br&gt;
這次有小部分功能都改過&lt;br&gt;
不過 diff 過後很快就找到問題點在一個 decode base64 的 function&lt;br&gt;
lucas 說第一個版本也又這個 function&lt;br&gt;
但是沒有被呼叫到&lt;br&gt;
接下來到結束時間都在研究如何觸發這個漏洞  &lt;/p&gt;
&lt;p&gt;內場其實發生很多事情外場都不清楚 &amp;gt;&amp;lt;&lt;br&gt;
比如說  &lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;主要得分來自前面種的後門&lt;/li&gt;
&lt;li&gt;&lt;code&gt;justify&lt;/code&gt; 持續掉分&lt;/li&gt;
&lt;li&gt;其他隊伍也有很多 wrapper 和 defense script，必須想辦法繞過&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;這些場外其實都第一時間沒得到消息...&lt;br&gt;
很多狀況都是回飯店討論時才知道的&lt;br&gt;
即使用 skype 還是有些不方便  &lt;/p&gt;
&lt;p&gt;晚上大家實在太累了&lt;br&gt;
吃完飯都決定回去小寐一會兒才陸續起來解題&lt;br&gt;
我睡到凌晨 1 點...鬧鐘沒設完就睡著了 = =&lt;br&gt;
好險沒睡到隔天&lt;br&gt;
醒來 lucas 和 atdog 已經讓 &lt;code&gt;imapv2&lt;/code&gt; 會 stack smash&lt;br&gt;
但是似乎沒辦法繞過 stack guard&lt;br&gt;
jery 則是說已經還原數個 &lt;code&gt;justify&lt;/code&gt; struct&lt;br&gt;
可以分工去 reverse 程式&lt;br&gt;
此時我們才開始交流內外場對這題的進度&lt;br&gt;
知道這題是吃 DIMACS CNF format 格式的文件後&lt;br&gt;
分析進度開始加速了起來  &lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;217: 這就是一題 hrms  &lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;jery 則把漏洞給補上&lt;br&gt;
用一種很巧秒的方式 XD&lt;br&gt;
將整個 stack 移到 environment variable 的位置&lt;br&gt;
這樣即使 overflow 也只會蓋到環境變數  &lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;em&gt;blue-lotus&lt;/em&gt;: 神思路! 太猥瑣了!  &lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;這題 patch 有一定難度&lt;br&gt;
很多隊伍只是把長度加大來騙人&lt;br&gt;
實際上只要改過 padding 長度依然可以 overflow&lt;br&gt;
可惜直到比賽我們最後還是沒有成功分析出 &lt;code&gt;justify&lt;/code&gt; 的演算法&lt;br&gt;
只能靠 replay 的方式重送&lt;br&gt;
也沒拿到什麼分數  &lt;/p&gt;
&lt;p&gt;至於其他兩題的進度&lt;br&gt;
sean 和 jeffxx 把 arm 版本的 &lt;code&gt;eliza&lt;/code&gt; 第二個漏洞給做出來&lt;br&gt;
&lt;code&gt;imapv2&lt;/code&gt; 可以對任意地址寫 1 byte&lt;br&gt;
但是找不到 memory leak 和可以利用的地方 OTZ  &lt;/p&gt;
&lt;h2&gt;8/10&lt;/h2&gt;
&lt;hr&gt;
&lt;p&gt;第三天大家莫名其妙又要排隊&lt;br&gt;
這次我們決定直接坐在沙發&lt;br&gt;
用無線網路存取內網 XD&lt;br&gt;
果然操作效率大幅提升阿!!!&lt;br&gt;
只可惜第三天真的太累了......&lt;br&gt;
沒辦法專注在分析 0 day&lt;br&gt;
分析 &lt;em&gt;ppp&lt;/em&gt; 的流量只看到一堆假流量毫無稍獲&lt;br&gt;
不過分析 &lt;em&gt;binja&lt;/em&gt; 、 &lt;em&gt;blue-lotus&lt;/em&gt;&lt;br&gt;
似乎都有嘗試對 &lt;code&gt;justify&lt;/code&gt; 發動攻擊&lt;br&gt;
另外 第三天 &lt;code&gt;wdup&lt;/code&gt; 還是有被攻擊成功&lt;br&gt;
由於第二天後半開始幾乎都是挨打的狀態&lt;br&gt;
不過修補及時 應該也沒有太大損害&lt;br&gt;
第三天沒有攻擊流量、也沒有分數排名&lt;br&gt;
(我看了螢幕三分鐘才發現是 replay ....  &lt;/p&gt;
&lt;p&gt;比賽就這樣平淡的結束了&lt;br&gt;
大家留下來拍照和聽主辦單位宣布一些事情&lt;br&gt;
也有跟其他隊伍稍微交流一下心得&lt;br&gt;
就回飯店休息了......實在是很累 = =&lt;br&gt;
睡到 4:30 以為是頒獎開始了 結果還沒&lt;br&gt;
只好回比賽場地繼續 social&lt;br&gt;
值得一提的是 &lt;em&gt;ghost in the shellcode&lt;/em&gt; 的成員來跟我們分享一些 CTF 的經驗&lt;br&gt;
他說自己已經比了 9 年&lt;br&gt;
隊伍花五年去弄出一套 framework 來幫助 CTF 競賽&lt;br&gt;
我們也跟他們提到 HITCON CTF&lt;br&gt;
說題目還沒出完&lt;br&gt;
他也回說完全了解出題的痛苦 XD&lt;br&gt;
&lt;img alt="IMG_1813.JPG" src="http://user-image.logdown.io/user/6149/blog/6156/post/220500/KTP0zJmeRyezvahV3trC_IMG_1813.JPG"&gt;  &lt;/p&gt;
&lt;p&gt;最後閉幕式在半夢半醒中度過&lt;br&gt;
聽到 &lt;em&gt;dragon sector&lt;/em&gt; 的名字我嚇了一大跳&lt;br&gt;
想說如果他們反超到第一名 那我們就死定啦&lt;br&gt;
第三天很多都是他們對我們發動攻擊 = =&lt;br&gt;
還好他們是第三 我們第二 &lt;em&gt;ppp&lt;/em&gt; 還是保持在第一&lt;br&gt;
跟第二天的名次完全一樣 XD&lt;br&gt;
插曲是因為宣布名次時攝影大哥剛好去上廁所&lt;br&gt;
在後面罵一聲 &lt;strong&gt;幹!!!&lt;/strong&gt; XDDD&lt;br&gt;
&lt;img alt="IMG_1815.JPG" src="http://user-image.logdown.io/user/6149/blog/6156/post/220500/BHzsEqRruLGYt3kQUZ3A_IMG_1815.JPG"&gt;  &lt;/p&gt;
&lt;p&gt;晚餐吃了奇怪的中式合菜&lt;br&gt;
除了那道青菜以外吃起來都不錯&lt;br&gt;
吃完大家都回去休息了&lt;br&gt;
sean &amp;amp; jeffxx &amp;amp; peter &amp;amp; me 四個人開始玩世紀二 XDD&lt;br&gt;
中間還發生 virtual box 跟 guest os 和 host 無縫接軌的神奇畫面...&lt;br&gt;
不過我真的玩得很爛 = =&lt;br&gt;
被改強的電腦打爆兩次&lt;br&gt;
最後一場改打塔快和城快結果電腦瞬間被虐爆....  &lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;sean: 怎麼差這麼多? 遊戲做壞了吧  &lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;之後改玩小遊戲...打了 40 幾分鐘&lt;br&gt;
打到兩邊都不想玩了 = =&lt;br&gt;
最後吃一碗泡麵做為一天的結束  &lt;/p&gt;
&lt;h2&gt;8/11&lt;/h2&gt;
&lt;hr&gt;
&lt;p&gt;最後一天早上在飯店聊天&lt;br&gt;
因為沒有微波爐可以熱昨天的炒飯&lt;br&gt;
只好很克難的吹風機加熱 XDDD&lt;br&gt;
親眼見證了 lucas 被 GD + dm4 的聯手推坑&lt;br&gt;
買完大家就在飯店裡玩 boss 耳機 XDD&lt;br&gt;
後來 alan 也買了一個  &lt;/p&gt;
&lt;p&gt;下午的行程大致就是...&lt;br&gt;
逛街逛到腿軟&lt;br&gt;
死觀光客模式快門按不停&lt;br&gt;
溫蒂漢堡很難吃&lt;br&gt;
搭飛機回家&lt;br&gt;
就不詳細贅述細節了  &lt;/p&gt;
&lt;p&gt;幹&lt;br&gt;
原本要傳 defcon 閉幕式的照片做結尾&lt;br&gt;
可是免費帳號不能傳照片了 = =  &lt;/p&gt;</content><category term="DEF CON CTF"></category></entry><entry><title>Cyber Readiness Challenge 2014 Level 1 Summary</title><link href="https://ddaa.tw/cyber_readiness_challenge_level1_summary.html" rel="alternate"></link><published>2014-04-02T22:51:00+08:00</published><updated>2014-04-02T22:51:00+08:00</updated><author><name>ddaa</name></author><id>tag:ddaa.tw,2014-04-02:/cyber_readiness_challenge_level1_summary.html</id><summary type="html">&lt;p&gt;今天跟 &lt;strong&gt;jeffxx&lt;/strong&gt; 和 &lt;strong&gt;atdog&lt;/strong&gt; 參加賽門鐵克主辦的 CTF&lt;br&gt;
見識到好多平常只有在網路上看過 id 的 大大 (worship)&lt;br&gt;
題目還滿有趣的~ 從中學到不少東西&lt;br&gt;
希望以後還會有機會參加 XD  &lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;故事背景是一個因為咖啡廳漲價而心生不滿的中二顧客&lt;br&gt;
決定黑咖啡廳的網路當作報復 (誤  &lt;/p&gt;
&lt;p&gt;題目環境給了一個 ip &lt;em&gt;10.1.1.10&lt;/em&gt;&lt;br&gt;
連過去會到咖啡廳的網站&lt;br&gt;
(因為題目環境是封閉的 所以只能稍微記錄一下做法了 &amp;gt;&amp;lt;)  &lt;/p&gt;
&lt;h2&gt;Problem 1 300&lt;/h2&gt;
&lt;p&gt;這題敘述是要找出咖啡廳是用什麼軟體架設的&lt;br&gt;
點開 source code 就看到註解裡面有記錄了&lt;br&gt;
flag: 忘了  &lt;/p&gt;
&lt;h2&gt;Problem 2 500&lt;/h2&gt;
&lt;p&gt;這題是要找到一個還沒使用過的優惠券&lt;br&gt;
點到網頁 &lt;em&gt;deals&lt;/em&gt; 的分類會看到兩個優惠券&lt;br&gt;
當然都不是 flag&lt;br&gt;
url 大概長這樣 &lt;code&gt;http://10 …&lt;/code&gt;&lt;/p&gt;</summary><content type="html">&lt;p&gt;今天跟 &lt;strong&gt;jeffxx&lt;/strong&gt; 和 &lt;strong&gt;atdog&lt;/strong&gt; 參加賽門鐵克主辦的 CTF&lt;br&gt;
見識到好多平常只有在網路上看過 id 的 大大 (worship)&lt;br&gt;
題目還滿有趣的~ 從中學到不少東西&lt;br&gt;
希望以後還會有機會參加 XD  &lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;故事背景是一個因為咖啡廳漲價而心生不滿的中二顧客&lt;br&gt;
決定黑咖啡廳的網路當作報復 (誤  &lt;/p&gt;
&lt;p&gt;題目環境給了一個 ip &lt;em&gt;10.1.1.10&lt;/em&gt;&lt;br&gt;
連過去會到咖啡廳的網站&lt;br&gt;
(因為題目環境是封閉的 所以只能稍微記錄一下做法了 &amp;gt;&amp;lt;)  &lt;/p&gt;
&lt;h2&gt;Problem 1 300&lt;/h2&gt;
&lt;p&gt;這題敘述是要找出咖啡廳是用什麼軟體架設的&lt;br&gt;
點開 source code 就看到註解裡面有記錄了&lt;br&gt;
flag: 忘了  &lt;/p&gt;
&lt;h2&gt;Problem 2 500&lt;/h2&gt;
&lt;p&gt;這題是要找到一個還沒使用過的優惠券&lt;br&gt;
點到網頁 &lt;em&gt;deals&lt;/em&gt; 的分類會看到兩個優惠券&lt;br&gt;
當然都不是 flag&lt;br&gt;
url 大概長這樣 &lt;code&gt;http://10.1.1.10/xxxx/deals/1&lt;/code&gt;&lt;br&gt;
很直覺的去改一下後面的參數&lt;br&gt;
改成 0 就發現多噴一個優惠券&lt;br&gt;
也就是此題的 flag&lt;br&gt;
flag: 忘了  &lt;/p&gt;
&lt;h2&gt;Problem 3 1000&lt;/h2&gt;
&lt;p&gt;這題是要我們找出隱藏的菜單或 &lt;em&gt;shopadmin&lt;/em&gt; 的 password&lt;br&gt;
上一題的 url 有 &lt;code&gt;SQLi&lt;/code&gt; 的漏洞&lt;br&gt;
但是我用 &lt;strong&gt;sqlmap&lt;/strong&gt; 爆不出來 QQ&lt;br&gt;
在用掉一個有等於沒有的提示後 (try sql syntax in url ... 類似這樣)&lt;br&gt;
確定是 SQli 的漏洞&lt;br&gt;
手動塞 payload&lt;br&gt;
得到 &lt;em&gt;shopadmin&lt;/em&gt; 的 &lt;code&gt;md5(password)&lt;/code&gt;&lt;br&gt;
拿去反查後得到 flag&lt;br&gt;
flag: &lt;code&gt;brewster&lt;/code&gt;  &lt;/p&gt;
&lt;h2&gt;Problem 4 500&lt;/h2&gt;
&lt;p&gt;某個 file 記錄著可以存取 WIFI 的 &lt;strong&gt;access code&lt;/strong&gt;&lt;br&gt;
flag 是 file 的完整路徑&lt;br&gt;
這題也是在網頁上找了很久&lt;br&gt;
結果用了提示才知道是要用 ssh 連進去 ._.&lt;br&gt;
file 就在家目錄下&lt;br&gt;
flag: 忘了  &lt;/p&gt;
&lt;h2&gt;Problem 5 300&lt;/h2&gt;
&lt;p&gt;要求 WIFI &lt;strong&gt;access code&lt;/strong&gt;&lt;br&gt;
就在剛剛的檔案裡 送分題&lt;br&gt;
flag: 忘了  &lt;/p&gt;
&lt;h2&gt;Problem 6 500&lt;/h2&gt;
&lt;p&gt;前面一堆描述忘記是啥了&lt;br&gt;
總之要找出 &lt;em&gt;10.1.2.15&lt;/em&gt; 的 hostname&lt;br&gt;
原本以為是用剛剛 ssh 進的主機去反解&lt;br&gt;
結果不是 =.=&lt;br&gt;
這台有開 &lt;strong&gt;netbios&lt;/strong&gt; 的 port&lt;br&gt;
google 一下可以用 &lt;strong&gt;netscan&lt;/strong&gt; 去掃&lt;br&gt;
就得到 hostname 了&lt;br&gt;
flag: 忘了  &lt;/p&gt;
&lt;h2&gt;Problem 7 1000&lt;/h2&gt;
&lt;p&gt;打進去就對了 bj4&lt;br&gt;
這題用到的漏洞是 &lt;strong&gt;MS08-067&lt;/strong&gt;&lt;br&gt;
第一次用 &lt;strong&gt;metasploit&lt;/strong&gt; XD&lt;br&gt;
還好這題沒更動什麼&lt;br&gt;
照著教學做就過了&lt;br&gt;
可是我前面不小心按到這題的 hint ... 悲劇&lt;br&gt;
flag: &lt;code&gt;emploees.zip&lt;/code&gt;  &lt;/p&gt;
&lt;h2&gt;Problem 8 300&lt;/h2&gt;
&lt;p&gt;該題環境還有另一個帳號&lt;br&gt;
&lt;strong&gt;metasploit&lt;/strong&gt; 開啟 shell 以後&lt;br&gt;
用 &lt;code&gt;net user&lt;/code&gt; 列出所有使用者&lt;br&gt;
flag: &lt;code&gt;manager&lt;/code&gt;  &lt;/p&gt;
&lt;h2&gt;Problem 9 1000&lt;/h2&gt;
&lt;p&gt;第 8 題得到的帳戶似乎密碼可以被破解&lt;br&gt;
flag 就是密碼&lt;br&gt;
用 &lt;strong&gt;metasploit&lt;/strong&gt; 內建的 &lt;code&gt;hashdump&lt;/code&gt; 得到密碼的 shadow&lt;br&gt;
這題我用網路上的方式爆不出 &lt;strong&gt;NTLM&lt;/strong&gt; 的密碼&lt;br&gt;
改用提示的 &lt;strong&gt;John The Ripper&lt;/strong&gt; 就爆出來了&lt;br&gt;
flag: &lt;code&gt;COFFEE123&lt;/code&gt;  &lt;/p&gt;
&lt;h2&gt;Problem 10 1000&lt;/h2&gt;
&lt;p&gt;第 7 題的 zip 有加密&lt;br&gt;
要想辦法破出密碼&lt;br&gt;
用 &lt;strong&gt;metasploit&lt;/strong&gt; 內建的 download 得到 zip 檔&lt;br&gt;
嘗試使用 &lt;strong&gt;fcrackzip&lt;/strong&gt; 去破解...但是跑不出來&lt;br&gt;
因為時間不太夠只好打開 hint&lt;br&gt;
提示要用 dictionary&lt;br&gt;
上網找的字典檔要 4G 來不及下載了&lt;br&gt;
在開一個提示才知道原來 kali 已經自帶字典檔了&lt;br&gt;
用 &lt;code&gt;rockyou.txt&lt;/code&gt; 成功解出壓縮檔密碼 &lt;code&gt;blingbling&lt;/code&gt;&lt;br&gt;
flag 在檔案裏面&lt;br&gt;
flag: 忘了  &lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;LEVEL 2 是賽門鐵克的產品&lt;br&gt;
根本沒人想去試...&lt;br&gt;
給個 24 小時再說吧 XD  &lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;LEVEL 3&lt;br&gt;
我開了一個 hint 但是登不進去環境 Q_Q&lt;br&gt;
最後把 hint 全開照著指示還是進不去 WTF~~~&lt;br&gt;
結果是主辦方那邊的 bug ORZ&lt;br&gt;
在分秒必爭之際...我發呆了半小時 囧rz&lt;br&gt;
最後 LEVEL3 只解兩題  so sad&lt;br&gt;
早知道學 atdog 大大 直接找漏洞打 (誤  &lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;結束前 scoreboard 就關閉了&lt;br&gt;
不知道自己確切的名次&lt;br&gt;
估計應該在 10 名上下吧 &amp;gt;&amp;lt;&lt;br&gt;
還有很大的努力空間呀~~&lt;br&gt;
這次的題目類型跟平常打的 CTF 相差滿大的&lt;br&gt;
不過也學到很多工具的使用方式&lt;br&gt;
感謝&lt;strong&gt;賽門鐵克&lt;/strong&gt;主辦這次活動&lt;br&gt;
以及 &lt;strong&gt;TDOH&lt;/strong&gt; 的宣傳 讓我有渠道可以參加這次活動~  &lt;/p&gt;</content><category term="Other CTF"></category></entry><entry><title>Olympic CTF 2014 10 point summary</title><link href="https://ddaa.tw/olympic_other_10_summary.html" rel="alternate"></link><published>2014-02-10T21:22:00+08:00</published><updated>2014-02-10T21:22:00+08:00</updated><author><name>ddaa</name></author><id>tag:ddaa.tw,2014-02-10:/olympic_other_10_summary.html</id><summary type="html">&lt;p&gt;這次的戰績只有慘不忍睹....&lt;br&gt;
除了 web200 以外&lt;br&gt;
其他解出的題目都只有 10 分 Orz&lt;br&gt;
Web200 Orange 大大的 &lt;a href="http://blog.orange.tw/2014/02/olympic-ctf-2014-curling-200-write-up.html"&gt;write up&lt;/a&gt; 已經很詳細了&lt;br&gt;
就不想再寫一份了 XD  &lt;/p&gt;
&lt;hr&gt;
&lt;h1&gt;Freestyle 10&lt;/h1&gt;
&lt;h2&gt;Trivial&lt;/h2&gt;
&lt;blockquote&gt;
&lt;p&gt;Hack the Planet_&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;這題 hitcon 也有出過 XD&lt;br&gt;
google 一下就知道是驚嘆號了&lt;br&gt;
btw, 這題原出處好像是 defcon  &lt;/p&gt;
&lt;h1&gt;CURLing 10&lt;/h1&gt;
&lt;h2&gt;Out there&lt;/h2&gt;
&lt;blockquote&gt;
&lt;p&gt;Flag is out there:&lt;br&gt;
http://[2a02:6b8:0:141f:fea9:d5ff:fed5:XX01]/&lt;br&gt;
Flag format …&lt;/p&gt;&lt;/blockquote&gt;</summary><content type="html">&lt;p&gt;這次的戰績只有慘不忍睹....&lt;br&gt;
除了 web200 以外&lt;br&gt;
其他解出的題目都只有 10 分 Orz&lt;br&gt;
Web200 Orange 大大的 &lt;a href="http://blog.orange.tw/2014/02/olympic-ctf-2014-curling-200-write-up.html"&gt;write up&lt;/a&gt; 已經很詳細了&lt;br&gt;
就不想再寫一份了 XD  &lt;/p&gt;
&lt;hr&gt;
&lt;h1&gt;Freestyle 10&lt;/h1&gt;
&lt;h2&gt;Trivial&lt;/h2&gt;
&lt;blockquote&gt;
&lt;p&gt;Hack the Planet_&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;這題 hitcon 也有出過 XD&lt;br&gt;
google 一下就知道是驚嘆號了&lt;br&gt;
btw, 這題原出處好像是 defcon  &lt;/p&gt;
&lt;h1&gt;CURLing 10&lt;/h1&gt;
&lt;h2&gt;Out there&lt;/h2&gt;
&lt;blockquote&gt;
&lt;p&gt;Flag is out there:&lt;br&gt;
http://[2a02:6b8:0:141f:fea9:d5ff:fed5:XX01]/&lt;br&gt;
Flag format: CTF{..32 hexes..}  &lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;這題難點是ipv6...&lt;br&gt;
由於我的機器沒辦法設定ipv6 route&lt;br&gt;
所以一開始沒辦法解 XD&lt;br&gt;
後來是到學校以後才發現學校有辦法瀏覽ipv6的web&lt;br&gt;
寫個批次檔一次開啟一堆網頁 (chrome 超強!)&lt;br&gt;
結果只有這個有畫面：&lt;br&gt;
&lt;code&gt;http://[2a02:6b8:0:141f:fea9:d5ff:fed5:6901]/&lt;/code&gt;&lt;br&gt;
看 source code 就找到flag了  &lt;/p&gt;
&lt;h1&gt;Binathlon 10&lt;/h1&gt;
&lt;h2&gt;Just No One&lt;/h2&gt;
&lt;blockquote&gt;
&lt;p&gt;Here's your binary: setup.exe&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;這題是最白爛的一題 XD&lt;br&gt;
附檔是一個利用 inno setup 包裝起來的一個安裝套件&lt;br&gt;
有密碼!&lt;br&gt;
用 ollydbg bypass 密碼以後可以正確安裝&lt;br&gt;
點擊程式...只會看到無限迴圈一直印&lt;br&gt;
&lt;code&gt;You already saw the flag&lt;/code&gt;&lt;br&gt;
一開始以為 flag 是安裝密碼&lt;br&gt;
但是 survey 以後發現 inno 比對的是 hash 過後的密碼&lt;br&gt;
所以 flag 應該不會在這&lt;br&gt;
隔天突然想通印出來的 msg 是提示&lt;br&gt;
然後把安裝前的 EULA 看一遍&lt;br&gt;
發現 flag 果然藏在那邊 XDD&lt;br&gt;
人生第一次認真看完 EULA....  &lt;/p&gt;
&lt;h1&gt;Figure Crypting 10&lt;/h1&gt;
&lt;h2&gt;Crypting&lt;/h2&gt;
&lt;blockquote&gt;
&lt;p&gt;43wdxz 4edcvgt5 65rdcvb 6tfcgh8uhb 9ijn&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;一開始以為是加密後的文字&lt;br&gt;
所以嘗試過 shift、substitution&lt;br&gt;
都解不出來.....&lt;br&gt;
後來自己打一遍發現這個string在鍵盤上的排列好像不太對勁...&lt;br&gt;
所以這五段代表的是五個英文字母...&lt;br&gt;
&lt;code&gt;sochi&lt;/code&gt;  &lt;/p&gt;
&lt;h1&gt;Nopsleigh 10&lt;/h1&gt;
&lt;h2&gt;As seen on DEFCON&lt;/h2&gt;
&lt;blockquote&gt;
&lt;p&gt;EBFE is to x86 as ____ is to ARM64  &lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;這題我沒解出來 :(&lt;br&gt;
survey以後發現 &lt;code&gt;EBFE&lt;/code&gt; 對於x86來說&lt;br&gt;
代表的是 &lt;code&gt;jmp 0x00&lt;/code&gt;&lt;br&gt;
所以就會變成無窮迴圈&lt;br&gt;
對於 arm64 來說 指令就是&lt;br&gt;
&lt;code&gt;b 0&lt;/code&gt; = &lt;code&gt;1400000&lt;/code&gt;&lt;br&gt;
我到這邊為止就卡住了&lt;br&gt;
後來才知道 arm64 要 little-endian&lt;br&gt;
所以是 &lt;code&gt;00000014&lt;/code&gt;.....&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;這次打完覺得自己還是太弱了 = =
比較需要技術性的都解到一半就解不下去
看來還需要多多加油 Orz&lt;/p&gt;</content><category term="Other CTF"></category></entry></feed>