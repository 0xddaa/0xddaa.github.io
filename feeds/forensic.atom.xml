<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom"><title>ddaa's blog - forensic</title><link href="https://ddaa.tw/" rel="alternate"></link><link href="https://ddaa.tw/feeds/forensic.atom.xml" rel="self"></link><id>https://ddaa.tw/</id><updated>2014-04-14T21:19:00+08:00</updated><entry><title>ACTF 2014 Crypto 老大哥aay的秘密</title><link href="https://ddaa.tw/actf_forensic_100_aay_secret.html" rel="alternate"></link><published>2014-04-14T21:19:00+08:00</published><updated>2014-04-14T21:19:00+08:00</updated><author><name>ddaa</name></author><id>tag:ddaa.tw,2014-04-14:/actf_forensic_100_aay_secret.html</id><summary type="html">&lt;p&gt;期中考完了來補一下 ACTF write up&lt;br&gt;
打完 plaidctf 覺得自己跟 學長 Orange 217 等大大&lt;br&gt;
差距十分之大 Orz&lt;br&gt;
要花更多時間練習才行 QQ  &lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;這題給了一個 rar 的檔案&lt;br&gt;
裡面包含 7 個檔案，每個 5 byte&lt;br&gt;
猜測應該是可以從 CRC32 brute-force 出結果&lt;br&gt;
測試一下&lt;br&gt;
&lt;code&gt;echo -ne 'ACTF' &amp;gt; tmp; crc32 tmp; cat tmp&lt;/code&gt;  &lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;76f37a57  &lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;跟 rar 的檔案吻合&lt;br&gt;
應該可以確認猜測無誤  &lt;/p&gt;
&lt;p&gt;接著要去 survey CRC32 的算法&lt;br&gt;
結果就找到現成的 code&lt;br&gt;
[http://www …&lt;/p&gt;</summary><content type="html">&lt;p&gt;期中考完了來補一下 ACTF write up&lt;br&gt;
打完 plaidctf 覺得自己跟 學長 Orange 217 等大大&lt;br&gt;
差距十分之大 Orz&lt;br&gt;
要花更多時間練習才行 QQ  &lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;這題給了一個 rar 的檔案&lt;br&gt;
裡面包含 7 個檔案，每個 5 byte&lt;br&gt;
猜測應該是可以從 CRC32 brute-force 出結果&lt;br&gt;
測試一下&lt;br&gt;
&lt;code&gt;echo -ne 'ACTF' &amp;gt; tmp; crc32 tmp; cat tmp&lt;/code&gt;  &lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;76f37a57  &lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;跟 rar 的檔案吻合&lt;br&gt;
應該可以確認猜測無誤  &lt;/p&gt;
&lt;p&gt;接著要去 survey CRC32 的算法&lt;br&gt;
結果就找到現成的 code&lt;br&gt;
[http://www.opensource.apple.com/source/xnu/xnu-1456.1.26/bsd/libkern/crc32.c]&lt;br&gt;
open source 所以可以隨便改 XD&lt;br&gt;
改成 linux 的版本以後就可以開始跑了&lt;br&gt;
因為是 flag 所以應該只有 printable&lt;br&gt;
測試 32 ~ 126&lt;br&gt;
約 5 分鐘跑出結果  &lt;/p&gt;
&lt;p&gt;flag: &lt;code&gt;ACTF{ch3ck5um_l34k_y0ur_1nf0m4710n}&lt;/code&gt;  &lt;/p&gt;</content><category term="XCTF"></category></entry><entry><title>Codegate CTF Preliminary 2014 150 WeirdShark</title><link href="https://ddaa.tw/codegate_forensic_150_weirdshark.html" rel="alternate"></link><published>2014-02-25T00:20:00+08:00</published><updated>2014-02-25T00:20:00+08:00</updated><author><name>ddaa</name></author><id>tag:ddaa.tw,2014-02-25:/codegate_forensic_150_weirdshark.html</id><summary type="html">&lt;p&gt;這題是這次 CTF 唯一的一題 Forensics ......  &lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;題目是一個 pcap 檔&lt;br&gt;
用 &lt;strong&gt;wireshark&lt;/strong&gt; 開啟卻出現錯誤訊息&lt;br&gt;
&lt;img alt="weirdshark1.PNG" src="https://ddaa.tw/images/codegate_2014_weirdshark_1.png"&gt;  &lt;/p&gt;
&lt;p&gt;看來是毀損了&lt;br&gt;
只好想辦法修復&lt;br&gt;
找到一個線上修復 pcap 的網站&lt;br&gt;
&lt;a href="http://f00l.de/pcapfix/"&gt;pcapfix&lt;/a&gt;  &lt;/p&gt;
&lt;p&gt;修復後再開一次檔案...fail again&lt;br&gt;
&lt;img alt="weirdshark2.PNG" src="https://ddaa.tw/images/codegate_2014_weirdshark_2.png"&gt;&lt;br&gt;
至少 &lt;em&gt;cap_len&lt;/em&gt; 變小了&lt;br&gt;
這次只好自己手動修復了 QQ&lt;br&gt;
&lt;code&gt;62 = 0x3E, 64 = 0x40&lt;/code&gt;&lt;br&gt;
搜尋一下 0x40&lt;br&gt;
嘗試改成 0x3E&lt;br&gt;
&lt;img alt="weirdshark3.PNG" src="https://ddaa.tw/images/codegate_2014_weirdshark_3.png"&gt;&lt;br&gt;
然後就 work 了... =.=  &lt;/p&gt;
&lt;p&gt;除了一般 tcp 就只出現 http了&lt;br&gt;
看到有 &lt;em&gt;GET /xxx.jpg&lt;/em&gt; 的可疑封包&lt;br&gt;
把檔案解開來看看&lt;br&gt;
&lt;code&gt;file -&amp;gt; extract object -&amp;gt; http&lt;/code&gt;&lt;br&gt;
將所有檔案檢查過以後 …&lt;/p&gt;</summary><content type="html">&lt;p&gt;這題是這次 CTF 唯一的一題 Forensics ......  &lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;題目是一個 pcap 檔&lt;br&gt;
用 &lt;strong&gt;wireshark&lt;/strong&gt; 開啟卻出現錯誤訊息&lt;br&gt;
&lt;img alt="weirdshark1.PNG" src="https://ddaa.tw/images/codegate_2014_weirdshark_1.png"&gt;  &lt;/p&gt;
&lt;p&gt;看來是毀損了&lt;br&gt;
只好想辦法修復&lt;br&gt;
找到一個線上修復 pcap 的網站&lt;br&gt;
&lt;a href="http://f00l.de/pcapfix/"&gt;pcapfix&lt;/a&gt;  &lt;/p&gt;
&lt;p&gt;修復後再開一次檔案...fail again&lt;br&gt;
&lt;img alt="weirdshark2.PNG" src="https://ddaa.tw/images/codegate_2014_weirdshark_2.png"&gt;&lt;br&gt;
至少 &lt;em&gt;cap_len&lt;/em&gt; 變小了&lt;br&gt;
這次只好自己手動修復了 QQ&lt;br&gt;
&lt;code&gt;62 = 0x3E, 64 = 0x40&lt;/code&gt;&lt;br&gt;
搜尋一下 0x40&lt;br&gt;
嘗試改成 0x3E&lt;br&gt;
&lt;img alt="weirdshark3.PNG" src="https://ddaa.tw/images/codegate_2014_weirdshark_3.png"&gt;&lt;br&gt;
然後就 work 了... =.=  &lt;/p&gt;
&lt;p&gt;除了一般 tcp 就只出現 http了&lt;br&gt;
看到有 &lt;em&gt;GET /xxx.jpg&lt;/em&gt; 的可疑封包&lt;br&gt;
把檔案解開來看看&lt;br&gt;
&lt;code&gt;file -&amp;gt; extract object -&amp;gt; http&lt;/code&gt;&lt;br&gt;
將所有檔案檢查過以後&lt;br&gt;
發現在 pdf 檔裡面有 flag XD&lt;br&gt;
&lt;img alt="flag.PNG" src="https://ddaa.tw/images/codegate_2014_weirdshark_flag.png"&gt;  &lt;/p&gt;
&lt;p&gt;flag: &lt;code&gt;FORENSICS_WITH_HAXORS&lt;/code&gt;  &lt;/p&gt;</content><category term="Codegate CTF"></category><category term="Wireshark"></category></entry><entry><title>GiTs 2014 Trivia 150 lugkist</title><link href="https://ddaa.tw/gits_trivia_150_lugkist.html" rel="alternate"></link><published>2014-01-20T19:04:00+08:00</published><updated>2014-01-20T19:04:00+08:00</updated><author><name>ddaa</name></author><id>tag:ddaa.tw,2014-01-20:/gits_trivia_150_lugkist.html</id><summary type="html">&lt;p&gt;這次的CTF全名是 : ghost in the shell code&lt;br&gt;
超級長 所以縮寫成 GiTs  &lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;將xz檔解壓縮以後得到的是一個純文字的文件&lt;br&gt;
前面兩行是 Find the key&lt;br&gt;
後面開始是好幾行的大寫英文字母 每行有六個字  &lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;GVZSNG
AXZIOG
YNAISG
ASAIUG
....&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;第一時間以為是 &lt;strong&gt;ADFGVX&lt;/strong&gt; 加密&lt;br&gt;
但是仔細看並不是這麼回事&lt;br&gt;
先寫個簡單的小程式來統計出現的字母&lt;br&gt;
發現文中只出現 &lt;strong&gt;AEGIKLNOPSTUVXYZ&lt;/strong&gt;&lt;br&gt;
於是就把這一串拿去 google&lt;br&gt;
找得到的討論串不多&lt;br&gt;
其中一個標題是 &lt;em&gt;SMB1 Game Genie thread of epic winness&lt;/em&gt;&lt;br&gt;
看完討論得知 &lt;strong&gt;AEGIKLNOPSTUVXYZ&lt;/strong&gt; 是某個遊戲機金手指的輸入字元&lt;br&gt;
&lt;img alt="game_genie.png" src="https://ddaa.tw/images/gits_2014_lugkist_1.png"&gt;&lt;/p&gt;
&lt;p&gt;於是以 &lt;strong&gt;Game Genie&lt;/strong&gt; 為關鍵字下去搜尋&lt;br&gt;
得知每一個 &lt;strong&gt;AEGIKLNOPSTUVXYZ&lt;/strong&gt; 的字串&lt;br&gt;
都可以對應到一個 hex …&lt;/p&gt;</summary><content type="html">&lt;p&gt;這次的CTF全名是 : ghost in the shell code&lt;br&gt;
超級長 所以縮寫成 GiTs  &lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;將xz檔解壓縮以後得到的是一個純文字的文件&lt;br&gt;
前面兩行是 Find the key&lt;br&gt;
後面開始是好幾行的大寫英文字母 每行有六個字  &lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;GVZSNG
AXZIOG
YNAISG
ASAIUG
....&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;第一時間以為是 &lt;strong&gt;ADFGVX&lt;/strong&gt; 加密&lt;br&gt;
但是仔細看並不是這麼回事&lt;br&gt;
先寫個簡單的小程式來統計出現的字母&lt;br&gt;
發現文中只出現 &lt;strong&gt;AEGIKLNOPSTUVXYZ&lt;/strong&gt;&lt;br&gt;
於是就把這一串拿去 google&lt;br&gt;
找得到的討論串不多&lt;br&gt;
其中一個標題是 &lt;em&gt;SMB1 Game Genie thread of epic winness&lt;/em&gt;&lt;br&gt;
看完討論得知 &lt;strong&gt;AEGIKLNOPSTUVXYZ&lt;/strong&gt; 是某個遊戲機金手指的輸入字元&lt;br&gt;
&lt;img alt="game_genie.png" src="https://ddaa.tw/images/gits_2014_lugkist_1.png"&gt;&lt;/p&gt;
&lt;p&gt;於是以 &lt;strong&gt;Game Genie&lt;/strong&gt; 為關鍵字下去搜尋&lt;br&gt;
得知每一個 &lt;strong&gt;AEGIKLNOPSTUVXYZ&lt;/strong&gt; 的字串&lt;br&gt;
都可以對應到一個 hex address&lt;br&gt;
所以我們要做的事情是&lt;br&gt;
把每一行的 ciphertext 轉換成 hex string  &lt;/p&gt;
&lt;p&gt;理論上應該是要研究他們轉換的算法&lt;br&gt;
不過我不小心 google 到別人寫好的 perl code XD&lt;br&gt;
轉換出來會得到兩段 hex string&lt;br&gt;
前半段是類似 &lt;strong&gt;ddab&lt;/strong&gt; 這種格式&lt;br&gt;
後半段則是一個 ASCII code&lt;br&gt;
用一開始的順序解出來的結果是&lt;br&gt;
&lt;code&gt;d   w P m   a   ?   d   i r c i e l m y w n c a a v p a h s i k v   t s n h t e n c e h o B g s a   o r   e   d e . y o e&lt;/code&gt;  &lt;/p&gt;
&lt;p&gt;完全看不出來是三小 XD&lt;br&gt;
所以推測前面的 hex string 應該是用來排序&lt;br&gt;
果然排序後就得到key了&lt;br&gt;
&lt;code&gt;P o w e r   o v e r w h e l m i n g ?   B a c k   i n   m y   d a y   c h e a t s   d i d   n o t   h a v e   s p a c e s .&lt;/code&gt;  &lt;/p&gt;
&lt;p&gt;flag: &lt;code&gt;Power overwhelming? Back in my day cheats did not have spaces.&lt;/code&gt;  &lt;/p&gt;</content><category term="Other CTF"></category></entry></feed>